<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Regression models â€¢ ALASCA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Regression models">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ALASCA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.16</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/ALASCA.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/plot.html">Plotting</a>
    </li>
    <li>
      <a href="../articles/prediction.html">Prediction</a>
    </li>
    <li>
      <a href="../articles/regression.html">Regression models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/andjar/ALASCA/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Regression models</h1>
                        <h4 data-toc-skip class="author">Anders H.
Jarmund</h4>
            
            <h4 data-toc-skip class="date">2024-07-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/andjar/ALASCA/blob/main/vignettes/articles/regression.Rmd" class="external-link"><code>vignettes/articles/regression.Rmd</code></a></small>
      <div class="hidden name"><code>regression.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="regression-models-in-alasca">Regression models in ALASCA<a class="anchor" aria-label="anchor" href="#regression-models-in-alasca"></a>
</h2>
<script src="js/hideOutput.js"></script><style>
.showopt {
  background-color: #004c93;
  color: #FFFFFF; 
  width: 150px;
  height: 20px;
  text-align: center;
  vertical-align: middle !important;
  float: left;
  font-family: sans-serif;
  border-radius: 8px;
}

.showopt:hover {
    background-color: #dfe4f2;
    color: #004c93;
}

.showopttext::before{
  content: "Show/Hide Source"
}

pre.plot {
  background-color: white !important;
}
</style>
<p>Please note: We do not comment on scaling in this vignette. For
details, see our paper <a href="https://www.frontiersin.org/articles/10.3389/fmolb.2022.962431/full" class="external-link">ALASCA:
An R package for longitudinal and cross-sectional analysis of
multivariate data by ASCA-based methods.</a></p>
<div class="section level3">
<h3 id="observational-data">Observational data<a class="anchor" aria-label="anchor" href="#observational-data"></a>
</h3>
<div class="section level4">
<h4 id="generating-a-data-set">Generating a data set<a class="anchor" aria-label="anchor" href="#generating-a-data-set"></a>
</h4>
<p>We will start by creating an artificial data set with 100
participants, 5 time points, 2 groups, and 20 variables. The variables
follow four patterns</p>
<ul>
<li>Linear increase</li>
<li>Linear decrease</li>
<li>A v-shape</li>
<li>An inverted v-shape</li>
</ul>
<p>The two groups are different at baseline and one of the groups have
larger changes throughout the study.</p>
<div class="fold s o">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_time</span>     <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">n_id</span>       <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">n_variable</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">rbindlist</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">n_id</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i_id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">rbindlist</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">n_variable</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i_variable</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">r_intercept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>    <span class="va">i_group</span> <span class="op">&lt;-</span> <span class="va">i_id</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">2</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">i_group</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">temp_data</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span></span>
<span>                  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"id_"</span>, <span class="va">i_id</span><span class="op">)</span>,</span>
<span>                  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"group_"</span>, <span class="va">i_group</span><span class="op">)</span>,</span>
<span>                  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n_time</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>                  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"variable_"</span>, <span class="va">i_variable</span><span class="op">)</span></span>
<span>                <span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">i_variable</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">4</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">temp_data</span><span class="op">[</span>, <span class="va">value</span> <span class="op">:=</span> <span class="va">r_intercept</span> <span class="op">+</span> <span class="va">beta</span> <span class="op">*</span> <span class="va">time</span><span class="op">]</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">i_variable</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">4</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">temp_data</span><span class="op">[</span>, <span class="va">value</span> <span class="op">:=</span> <span class="va">r_intercept</span> <span class="op">-</span> <span class="va">beta</span> <span class="op">*</span> <span class="va">time</span><span class="op">]</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">i_variable</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">4</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">temp_data</span><span class="op">[</span>, <span class="va">value</span> <span class="op">:=</span> <span class="va">r_intercept</span> <span class="op">+</span> <span class="va">beta</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">time</span> <span class="op">-</span> <span class="va">n_time</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">temp_data</span><span class="op">[</span>, <span class="va">value</span> <span class="op">:=</span> <span class="va">r_intercept</span> <span class="op">-</span> <span class="va">beta</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">time</span> <span class="op">-</span> <span class="va">n_time</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">temp_data</span><span class="op">[</span>, <span class="va">value</span> <span class="op">:=</span> <span class="va">value</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_time</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">temp_data</span><span class="op">[</span>, <span class="va">value</span> <span class="op">:=</span> <span class="va">value</span> <span class="op">*</span> <span class="va">i_variable</span><span class="op">/</span><span class="fl">2</span><span class="op">]</span></span>
<span>    <span class="va">temp_data</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Overall (ignoring the random effects), the four patterns look like
this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="va">variable</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"variable_1"</span>, <span class="st">"variable_2"</span>, <span class="st">"variable_3"</span>, <span class="st">"variable_4"</span><span class="op">)</span>,<span class="op">]</span>,</span>
<span>       <span class="fu">aes</span><span class="op">(</span><span class="va">time</span>, <span class="va">value</span>, color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_viridis_d</span><span class="op">(</span>end <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="regression_files/figure-html/unnamed-chunk-4-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>We want time to be a categorical variable:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">[</span>, <span class="va">time</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"t_"</span>, <span class="va">time</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="common-time-and-group-development">Common time and group development<a class="anchor" aria-label="anchor" href="#common-time-and-group-development"></a>
</h4>
<p>With ALASCA, you can either assess how the two groups develop
overall, or you can focus your analyses on how they diverge (see below).
In R, you commonly specify your regression equation as
<code>value ~ v1*v2 + (1|v3)</code> where <code>value</code> is outcome,
<code>v1</code> and <code>v2</code> are predictors, and <code>v3</code>
defines the random intercept. <code>v1*v2</code> is shorthand for
<code>v1 + v1:v2 + v2</code>, that is, the main effects of
<code>v1</code>, <code>v2</code>, and their interaction
<code>v1:v2</code>. You can, of course, also write
<code>v1 + v1:v2 + v2</code> - this will become important when you do
<em>not</em> want the main effect of <code>v2</code> (see randomized
trial below).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ALASCA.html">ALASCA</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  <span class="va">value</span> <span class="op">~</span> <span class="va">time</span><span class="op">*</span><span class="va">group</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:00] Initializing ALASCA (v1.0.16, 2024-02-15)</span></span>
<span><span class="co">#&gt; WARN  [2024-07-15 10:21:00] Guessing effects: `time+time:group+group`</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:00] Will use linear mixed models!</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:00] Will use Rfast!</span></span>
<span><span class="co">#&gt; WARN  [2024-07-15 10:21:00] The `group` column is used for stratification</span></span>
<span><span class="co">#&gt; WARN  [2024-07-15 10:21:00] Converting `character` columns to factors</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:00] Scaling data with sdall ...</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:00] Calculating LMM coefficients</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:00] ==== ALASCA has finished ====</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:00] To visualize the model, try `plot(&lt;object&gt;, effect = 1, component = 1, type = 'effect')`</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, component <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'effect'</span><span class="op">)</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:00] Effect plot. Selected effect (nr 1): `time+time:group+group`. Component: 1 and 2.</span></span></code></pre></div>
<p><img src="regression_files/figure-html/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="accessing-the-regression-coefficients-and-p-values">Accessing the regression coefficients and p-values<a class="anchor" aria-label="anchor" href="#accessing-the-regression-coefficients-and-p-values"></a>
</h4>
<p>The regression coefficients can be fetched with:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span><span class="op">$</span><span class="va">regression_coefficients</span></span>
<span><span class="co">#&gt;                  variable      covar    estimate pvalue</span></span>
<span><span class="co">#&gt;                    &lt;char&gt;     &lt;char&gt;       &lt;num&gt; &lt;lgcl&gt;</span></span>
<span><span class="co">#&gt;   1:          (Intercept) variable_1 -0.02424694     NA</span></span>
<span><span class="co">#&gt;   2:              timet_1 variable_1 -0.44769975     NA</span></span>
<span><span class="co">#&gt;   3:              timet_2 variable_1 -0.90615208     NA</span></span>
<span><span class="co">#&gt;   4:              timet_3 variable_1 -1.32768478     NA</span></span>
<span><span class="co">#&gt;   5:              timet_4 variable_1 -1.75964143     NA</span></span>
<span><span class="co">#&gt;  ---                                                   </span></span>
<span><span class="co">#&gt; 196:         groupgroup_1 variable_9 -0.05143755     NA</span></span>
<span><span class="co">#&gt; 197: timet_1:groupgroup_1 variable_9  0.13396188     NA</span></span>
<span><span class="co">#&gt; 198: timet_2:groupgroup_1 variable_9  0.33100413     NA</span></span>
<span><span class="co">#&gt; 199: timet_3:groupgroup_1 variable_9  0.41887184     NA</span></span>
<span><span class="co">#&gt; 200: timet_4:groupgroup_1 variable_9  0.61557106     NA</span></span></code></pre></div>
<p>P-values are not available when you use hte <a href="https://cran.r-project.org/web/packages/Rfast/index.html" class="external-link">Rfast
package</a>. If you choose to use the <a href="https://cran.r-project.org/web/packages/lme4/index.html" class="external-link">lme4
package</a> instead, p-values will be estimated with the <a href="https://cran.r-project.org/web/packages/lmerTest/index.html" class="external-link">lmerTest
package</a>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ALASCA.html">ALASCA</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  <span class="va">value</span> <span class="op">~</span> <span class="va">time</span><span class="op">*</span><span class="va">group</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">id</span><span class="op">)</span>,</span>
<span>  use_Rfast <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:02] Initializing ALASCA (v1.0.16, 2024-02-15)</span></span>
<span><span class="co">#&gt; WARN  [2024-07-15 10:21:02] Guessing effects: `time+time:group+group`</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:02] Will use linear mixed models!</span></span>
<span><span class="co">#&gt; WARN  [2024-07-15 10:21:02] The `group` column is used for stratification</span></span>
<span><span class="co">#&gt; WARN  [2024-07-15 10:21:02] Converting `character` columns to factors</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:02] Scaling data with sdall ...</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:02] Calculating LMM coefficients</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:03] ==== ALASCA has finished ====</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:03] To visualize the model, try `plot(&lt;object&gt;, effect = 1, component = 1, type = 'effect')`</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">regression_coefficients</span></span>
<span><span class="co">#&gt;         estimate        pvalue      covar             variable</span></span>
<span><span class="co">#&gt;            &lt;num&gt;         &lt;num&gt;     &lt;char&gt;               &lt;char&gt;</span></span>
<span><span class="co">#&gt;   1: -0.02424694  8.401427e-01 variable_1          (Intercept)</span></span>
<span><span class="co">#&gt;   2: -0.44769975  1.238382e-15 variable_1              timet_1</span></span>
<span><span class="co">#&gt;   3: -0.90615208  1.779872e-48 variable_1              timet_2</span></span>
<span><span class="co">#&gt;   4: -1.32768478  4.240143e-82 variable_1              timet_3</span></span>
<span><span class="co">#&gt;   5: -1.75964143 2.000954e-114 variable_1              timet_4</span></span>
<span><span class="co">#&gt;  ---                                                          </span></span>
<span><span class="co">#&gt; 196: -0.05143755  7.707747e-01 variable_9         groupgroup_1</span></span>
<span><span class="co">#&gt; 197:  0.13396188  8.168277e-02 variable_9 timet_1:groupgroup_1</span></span>
<span><span class="co">#&gt; 198:  0.33100413  2.041440e-05 variable_9 timet_2:groupgroup_1</span></span>
<span><span class="co">#&gt; 199:  0.41887184  8.565824e-08 variable_9 timet_3:groupgroup_1</span></span>
<span><span class="co">#&gt; 200:  0.61557106  1.227176e-14 variable_9 timet_4:groupgroup_1</span></span></code></pre></div>
<p>You can also specify a method to adjust for multiple testing (by
default, unadjusted p-values are provided). Here, Benjamini-Hochberg is
used (alternative:
<code>c("holm", "hochberg", "hommel", "bonferroni", "BH", "BY", "fdr", "none")</code>):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ALASCA.html">ALASCA</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  <span class="va">value</span> <span class="op">~</span> <span class="va">time</span><span class="op">*</span><span class="va">group</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">id</span><span class="op">)</span>,</span>
<span>  use_Rfast <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  p_adjust_method <span class="op">=</span> <span class="st">"BH"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:03] Initializing ALASCA (v1.0.16, 2024-02-15)</span></span>
<span><span class="co">#&gt; WARN  [2024-07-15 10:21:03] Guessing effects: `time+time:group+group`</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:03] Will use linear mixed models!</span></span>
<span><span class="co">#&gt; WARN  [2024-07-15 10:21:04] The `group` column is used for stratification</span></span>
<span><span class="co">#&gt; WARN  [2024-07-15 10:21:04] Converting `character` columns to factors</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:04] Scaling data with sdall ...</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:04] Calculating LMM coefficients</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:04] Adjusting p values</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:04] ==== ALASCA has finished ====</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:04] To visualize the model, try `plot(&lt;object&gt;, effect = 1, component = 1, type = 'effect')`</span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">regression_coefficients</span></span>
<span><span class="co">#&gt;         estimate        pvalue      covar             variable  pvalue_unadj</span></span>
<span><span class="co">#&gt;            &lt;num&gt;         &lt;num&gt;     &lt;char&gt;               &lt;char&gt;         &lt;num&gt;</span></span>
<span><span class="co">#&gt;   1: -0.02424694  8.651323e-01 variable_1          (Intercept)  8.401427e-01</span></span>
<span><span class="co">#&gt;   2: -0.44769975  1.905203e-15 variable_1              timet_1  1.238382e-15</span></span>
<span><span class="co">#&gt;   3: -0.90615208  2.738265e-48 variable_1              timet_2  1.779872e-48</span></span>
<span><span class="co">#&gt;   4: -1.32768478  1.211469e-81 variable_1              timet_3  4.240143e-82</span></span>
<span><span class="co">#&gt;   5: -1.75964143 1.333970e-113 variable_1              timet_4 2.000954e-114</span></span>
<span><span class="co">#&gt;  ---                                                                        </span></span>
<span><span class="co">#&gt; 196: -0.05143755  8.113418e-01 variable_9         groupgroup_1  7.707747e-01</span></span>
<span><span class="co">#&gt; 197:  0.13396188  1.089104e-01 variable_9 timet_1:groupgroup_1  8.168277e-02</span></span>
<span><span class="co">#&gt; 198:  0.33100413  2.916342e-05 variable_9 timet_2:groupgroup_1  2.041440e-05</span></span>
<span><span class="co">#&gt; 199:  0.41887184  1.427637e-07 variable_9 timet_3:groupgroup_1  8.565824e-08</span></span>
<span><span class="co">#&gt; 200:  0.61557106  6.135881e-14 variable_9 timet_4:groupgroup_1  1.227176e-14</span></span></code></pre></div>
<p>The values are then adjusted within each variable level (e.g.,
adjusted within time point 1).</p>
</div>
<div class="section level4">
<h4 id="separating-time-and-group-effects">Separating time and group effects<a class="anchor" aria-label="anchor" href="#separating-time-and-group-effects"></a>
</h4>
<p>Now, we would like to assess how the two groups <em>diverge</em> over
time. To do this, we will separate the time and group effect:
<code>separate_effects = TRUE</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ALASCA.html">ALASCA</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  <span class="va">value</span> <span class="op">~</span> <span class="va">time</span><span class="op">*</span><span class="va">group</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">id</span><span class="op">)</span>,</span>
<span>  separate_effects <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:05] Initializing ALASCA (v1.0.16, 2024-02-15)</span></span>
<span><span class="co">#&gt; WARN  [2024-07-15 10:21:05] Guessing effects: `time` and `time:group+group`</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:05] Will use linear mixed models!</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:05] Will use Rfast!</span></span>
<span><span class="co">#&gt; WARN  [2024-07-15 10:21:05] The `group` column is used for stratification</span></span>
<span><span class="co">#&gt; WARN  [2024-07-15 10:21:05] Converting `character` columns to factors</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:05] Scaling data with sdall ...</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:05] Calculating LMM coefficients</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:05] ==== ALASCA has finished ====</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:05] To visualize the model, try `plot(&lt;object&gt;, effect = 1, component = 1, type = 'effect')`</span></span></code></pre></div>
<p>Importantly, we must plot the two effects separately. We begin with
the time effect of the reference group:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, component <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, effect <span class="op">=</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="st">'effect'</span><span class="op">)</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:05] Effect plot. Selected effect (nr 2): `time:group+group`. Component: 1 and 2.</span></span></code></pre></div>
<p><img src="regression_files/figure-html/unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Next, we will look at the effect of group and how the two groups
<em>differ</em>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/flip.html">flip</a></span><span class="op">(</span><span class="va">res</span>, effect <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># We flip the model to simplify the comparison with the previous model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, component <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, effect <span class="op">=</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="st">'effect'</span><span class="op">)</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:06] Effect plot. Selected effect (nr 2): `time:group+group`. Component: 1 and 2.</span></span></code></pre></div>
<p><img src="regression_files/figure-html/unnamed-chunk-12-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>In short, we can see that the difference between the two groups
increases for some variables (e.g., <code>variable_13</code> and
<code>variable_8</code>). But, the lower plot shows that some variables
become more <em>similar</em> with time (e.g., <code>variable_15</code>).
An easy way to confirm how a variable develops is to look at the
marginal means. For example, <code>variable_8</code>,
<code>variable_13</code>, and <code>variable_15</code> can be assessed
like this:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, type <span class="op">=</span> <span class="st">'prediction'</span>, variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"variable_8"</span>, <span class="st">"variable_13"</span>, <span class="st">"variable_15"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:08] Prediction plot. Selected effect (nr 1): `time`. Component: 1.</span></span></code></pre></div>
<p><img src="regression_files/figure-html/unnamed-chunk-13-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>See <a href="articles/plot.html">the vignette on plotting the
model</a> for more visualizations.</p>
</div>
</div>
<div class="section level3">
<h3 id="randomized-interventional-data">Randomized, interventional data<a class="anchor" aria-label="anchor" href="#randomized-interventional-data"></a>
</h3>
<div class="section level4">
<h4 id="generating-a-data-set-1">Generating a data set<a class="anchor" aria-label="anchor" href="#generating-a-data-set-1"></a>
</h4>
<p>We will start by creating an artificial data set with 100
participants, 5 time points, 2 groups, and 20 variables. The variables
follow four patterns</p>
<ul>
<li>Linear increase</li>
<li>Linear decrease</li>
<li>A v-shape</li>
<li>An inverted v-shape</li>
</ul>
<p>The two groups have similar baseline, but one of the groups have a
larger change in the values.</p>
<div class="fold s o">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_time</span>     <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">n_id</span>       <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">n_variable</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">rbindlist</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">n_id</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i_id</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">rbindlist</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">n_variable</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i_variable</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">r_intercept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>    <span class="va">i_group</span> <span class="op">&lt;-</span> <span class="va">i_id</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">2</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">i_group</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">temp_data</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="op">(</span></span>
<span>                  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"id_"</span>, <span class="va">i_id</span><span class="op">)</span>,</span>
<span>                  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"group_"</span>, <span class="va">i_group</span><span class="op">)</span>,</span>
<span>                  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n_time</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>                  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"variable_"</span>, <span class="va">i_variable</span><span class="op">)</span></span>
<span>                <span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">i_variable</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">4</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">temp_data</span><span class="op">[</span>, <span class="va">value</span> <span class="op">:=</span> <span class="va">r_intercept</span> <span class="op">+</span> <span class="va">beta</span> <span class="op">*</span> <span class="va">time</span><span class="op">]</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">i_variable</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">4</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">temp_data</span><span class="op">[</span>, <span class="va">value</span> <span class="op">:=</span> <span class="va">r_intercept</span> <span class="op">-</span> <span class="va">beta</span> <span class="op">*</span> <span class="va">time</span><span class="op">]</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="va">i_variable</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">4</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">temp_data</span><span class="op">[</span>, <span class="va">value</span> <span class="op">:=</span> <span class="va">r_intercept</span> <span class="op">-</span> <span class="va">beta</span><span class="op">*</span><span class="va">n_time</span><span class="op">/</span><span class="fl">2</span> <span class="op">+</span> <span class="va">beta</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">time</span> <span class="op">-</span> <span class="va">n_time</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span> <span class="co"># Note: set to intercept at baseline</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">temp_data</span><span class="op">[</span>, <span class="va">value</span> <span class="op">:=</span> <span class="va">r_intercept</span> <span class="op">+</span> <span class="va">beta</span><span class="op">*</span><span class="va">n_time</span><span class="op">/</span><span class="fl">2</span> <span class="op">-</span> <span class="va">beta</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">time</span> <span class="op">-</span> <span class="va">n_time</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span> <span class="co"># Note: set to intercept at baseline</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">temp_data</span><span class="op">[</span>, <span class="va">value</span> <span class="op">:=</span> <span class="va">value</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_time</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">temp_data</span><span class="op">[</span>, <span class="va">value</span> <span class="op">:=</span> <span class="va">value</span> <span class="op">*</span> <span class="va">i_variable</span><span class="op">/</span><span class="fl">2</span><span class="op">]</span></span>
<span>    <span class="va">temp_data</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<p>Overall (ignoring the random effects), the four patterns look like
this:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="va">variable</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"variable_1"</span>, <span class="st">"variable_2"</span>, <span class="st">"variable_3"</span>, <span class="st">"variable_4"</span><span class="op">)</span>,<span class="op">]</span>,</span>
<span>       <span class="fu">aes</span><span class="op">(</span><span class="va">time</span>, <span class="va">value</span>, color <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_viridis_d</span><span class="op">(</span>end <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~ x'</span></span></code></pre></div>
<p><img src="regression_files/figure-html/unnamed-chunk-15-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>We want time to be a categorical variable:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">[</span>, <span class="va">time</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"t_"</span>, <span class="va">time</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="regression-model">Regression model<a class="anchor" aria-label="anchor" href="#regression-model"></a>
</h4>
<p>A regression model that assumes equal baseline between the two groups
can be defined as:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ALASCA.html">ALASCA</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  <span class="va">value</span> <span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="va">time</span><span class="op">:</span><span class="va">group</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">id</span><span class="op">)</span>,</span>
<span>  equal_baseline <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:12] Initializing ALASCA (v1.0.16, 2024-02-15)</span></span>
<span><span class="co">#&gt; WARN  [2024-07-15 10:21:12] Guessing effects: `time+time:group`</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:12] Will use linear mixed models!</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:12] Will use Rfast!</span></span>
<span><span class="co">#&gt; WARN  [2024-07-15 10:21:12] The `group` column is used for stratification</span></span>
<span><span class="co">#&gt; WARN  [2024-07-15 10:21:12] Converting `character` columns to factors</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:12] Scaling data with sdall ...</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:12] Calculating LMM coefficients</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:12] ==== ALASCA has finished ====</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:12] To visualize the model, try `plot(&lt;object&gt;, effect = 1, component = 1, type = 'effect')`</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, component <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'effect'</span><span class="op">)</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:12] Effect plot. Selected effect (nr 1): `time+time:group`. Component: 1 and 2.</span></span></code></pre></div>
<p><img src="regression_files/figure-html/unnamed-chunk-17-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Why is <code>equal_baseline = TRUE</code> necessary? Well, it is due
to how the model matrices are made by r - by default, there is an
interaction term between group and the first time point. Just look at
these two model matrices:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ALASCA.html">ALASCA</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  <span class="va">value</span> <span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="va">time</span><span class="op">:</span><span class="va">group</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">id</span><span class="op">)</span>,</span>
<span>  equal_baseline <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:13] Initializing ALASCA (v1.0.16, 2024-02-15)</span></span>
<span><span class="co">#&gt; WARN  [2024-07-15 10:21:13] Guessing effects: `time+time:group`</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:13] Will use linear mixed models!</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:13] Will use Rfast!</span></span>
<span><span class="co">#&gt; WARN  [2024-07-15 10:21:13] The `group` column is used for stratification</span></span>
<span><span class="co">#&gt; WARN  [2024-07-15 10:21:13] Converting `character` columns to factors</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:13] Scaling data with sdall ...</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:13] Calculating LMM coefficients</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:13] ==== ALASCA has finished ====</span></span>
<span><span class="co">#&gt; INFO  [2024-07-15 10:21:13] To visualize the model, try `plot(&lt;object&gt;, effect = 1, component = 1, type = 'effect')`</span></span>
<span></span>
<span><span class="va">res</span><span class="op">$</span><span class="va">effect_list</span><span class="op">$</span><span class="va">model_matrix</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;   timet_1 timet_2 timet_3 timet_4 timet_1:groupgroup_1 timet_2:groupgroup_1</span></span>
<span><span class="co">#&gt; 1       0       0       0       0                    0                    0</span></span>
<span><span class="co">#&gt; 2       1       0       0       0                    1                    0</span></span>
<span><span class="co">#&gt; 3       0       1       0       0                    0                    1</span></span>
<span><span class="co">#&gt;   timet_3:groupgroup_1 timet_4:groupgroup_1</span></span>
<span><span class="co">#&gt; 1                    0                    0</span></span>
<span><span class="co">#&gt; 2                    0                    0</span></span>
<span><span class="co">#&gt; 3                    0                    0</span></span>
<span><span class="va">res_2</span><span class="op">$</span><span class="va">effect_list</span><span class="op">$</span><span class="va">model_matrix</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;   timet_1 timet_2 timet_3 timet_4 timet_0:groupgroup_1 timet_1:groupgroup_1</span></span>
<span><span class="co">#&gt; 1       0       0       0       0                    1                    0</span></span>
<span><span class="co">#&gt; 2       1       0       0       0                    0                    1</span></span>
<span><span class="co">#&gt; 3       0       1       0       0                    0                    0</span></span>
<span><span class="co">#&gt;   timet_2:groupgroup_1 timet_3:groupgroup_1 timet_4:groupgroup_1</span></span>
<span><span class="co">#&gt; 1                    0                    0                    0</span></span>
<span><span class="co">#&gt; 2                    0                    0                    0</span></span>
<span><span class="co">#&gt; 3                    1                    0                    0</span></span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Anders H. Jarmund.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
