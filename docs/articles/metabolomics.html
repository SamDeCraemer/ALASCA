<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Metabolomics • RMASCA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Metabolomics">
<meta property="og:description" content="RMASCA">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RMASCA</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Under development">0.0.0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/RMASCA.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/metabolomics.html">Metabolomics</a>
    </li>
    <li>
      <a href="../articles/pregnancy.html">Early Preeclampsia</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="metabolomics_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Metabolomics</h1>
            
      
      
      <div class="hidden name"><code>metabolomics.Rmd</code></div>

    </div>

    
    
<div id="metabolomics" class="section level1">
<h1 class="hasAnchor">
<a href="#metabolomics" class="anchor"></a>Metabolomics</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">RMASCA</span><span class="op">)</span></code></pre></div>
<p>This time we will look at a small metabolomics dataset by <span class="citation">Euceda et al. (2017)</span> and replicate the findings of <span class="citation">Madssen et al. (2020)</span>. Let us start by having a quick look at it:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span>
  <span class="fu">ggpubr</span><span class="fu">::</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html">ggarrange</a></span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/plotParts.html">plotParts</a></span><span class="op">(</span><span class="va">df</span>, participantColumn <span class="op">=</span> <span class="st">"ID"</span>, valueColumn <span class="op">=</span> <span class="st">"value"</span>, addSmooth <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>, 
                      common.legend <span class="op">=</span> <span class="cn">TRUE</span>, legend <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<p><img src="metabolomics_files/figure-html/unnamed-chunk-2-1.png" width="100%" style="display: block; margin: auto;"></p>
So there is three time points, two groups and 16 variables. ??? state that
<blockquote>
All metabolite responses were log-transformed before analysis, and the effect matrix was mean-centered before PCA.
</blockquote>
<p>But our data is already log-transformed, and centering is handled by RMASCA(). But we need to scale each metabolite with the standard deviation at baseline, as instructed by the authors. So let us set the desired reference groups and normalize:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html">relevel</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">group</span>, ref <span class="op">=</span> <span class="st">"Chemotherapy only"</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html">relevel</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">time</span>, ref <span class="op">=</span> <span class="st">"TP1"</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">variable</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="va">df</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">variable</span> <span class="op">==</span> <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">variable</span> <span class="op">==</span> <span class="va">i</span><span class="op">]</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">variable</span> <span class="op">==</span> <span class="va">i</span> <span class="op">&amp;</span> <span class="va">df</span><span class="op">$</span><span class="va">time</span> <span class="op">==</span> <span class="st">"TP1"</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Without any fuss, let us see what RMASCA makes out of it using the same model as <span class="citation">Madssen et al. (2020)</span>. Note that we have to <code>forceEqualBaseline</code> to remove the interaction term for TP1 * treatment.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">form</span> <span class="op">&lt;-</span> <span class="va">value</span> <span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="va">time</span><span class="op">:</span><span class="va">group</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">ID</span><span class="op">)</span>
<span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RMASCA.html">RMASCA</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">form</span>, separateTimeAndGroup <span class="op">=</span> <span class="cn">FALSE</span>, forceEqualBaseline <span class="op">=</span> <span class="cn">TRUE</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; Calculating LMM coefficients...</span>
<span class="co">#&gt; Registered S3 methods overwritten by 'lme4':</span>
<span class="co">#&gt;   method                          from</span>
<span class="co">#&gt;   cooks.distance.influence.merMod car </span>
<span class="co">#&gt;   influence.merMod                car </span>
<span class="co">#&gt;   dfbeta.influence.merMod         car </span>
<span class="co">#&gt;   dfbetas.influence.merMod        car</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span>
<span class="co">#&gt; Finished calculating LMM coefficients!</span>
<span class="co">#&gt; Calculating effect matrix</span>
<span class="co">#&gt; Finished calculating effect matrix!</span></code></pre></div>
<p>Let us check that our model is as expected:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">lmer.models</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; Linear mixed model fit by REML. t-tests use Satterthwaite's method [</span>
<span class="co">#&gt; lmerModLmerTest]</span>
<span class="co">#&gt; Formula: object$newFormula</span>
<span class="co">#&gt;    Data: subset(object$df, variable == i)</span>
<span class="co">#&gt; Control: lme4::lmerControl(calc.derivs = FALSE)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; REML criterion at convergence: 761.7</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Scaled residuals: </span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -2.9769 -0.4910  0.1554  0.5865  2.2444 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Random effects:</span>
<span class="co">#&gt;  Groups   Name        Variance Std.Dev.</span>
<span class="co">#&gt;  ID       (Intercept) 0.2480   0.4980  </span>
<span class="co">#&gt;  Residual             0.7558   0.8694  </span>
<span class="co">#&gt; Number of obs: 270, groups:  ID, 122</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Fixed effects:</span>
<span class="co">#&gt;                                    Estimate Std. Error        df t value</span>
<span class="co">#&gt; (Intercept)                         0.49104    0.09724 252.05390   5.050</span>
<span class="co">#&gt; XtimeTP2                            0.37490    0.16984 211.02402   2.207</span>
<span class="co">#&gt; XtimeTP3                            0.90964    0.17427 220.72035   5.220</span>
<span class="co">#&gt; XtimeTP2:groupBevacizumab treated   0.40580    0.21992 256.50552   1.845</span>
<span class="co">#&gt; XtimeTP3:groupBevacizumab treated   0.55303    0.20953 258.87566   2.639</span>
<span class="co">#&gt;                                   Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)                       8.49e-07 ***</span>
<span class="co">#&gt; XtimeTP2                           0.02837 *  </span>
<span class="co">#&gt; XtimeTP3                          4.13e-07 ***</span>
<span class="co">#&gt; XtimeTP2:groupBevacizumab treated  0.06616 .  </span>
<span class="co">#&gt; XtimeTP3:groupBevacizumab treated  0.00881 ** </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Correlation of Fixed Effects:</span>
<span class="co">#&gt;             (Intr) XtmTP2 XtmTP3 XTP2:t</span>
<span class="co">#&gt; XtimeTP2    -0.451                     </span>
<span class="co">#&gt; XtimeTP3    -0.449  0.312              </span>
<span class="co">#&gt; XtmTP2:grBt -0.001 -0.615 -0.084       </span>
<span class="co">#&gt; XtmTP3:grBt  0.013 -0.096 -0.670  0.139</span>
<span class="co">#&gt; fit warnings:</span>
<span class="co">#&gt; fixed-effect model matrix is rank deficient so dropping 1 column / coefficient</span></code></pre></div>
<p>And now, let us plot it:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html">screeplot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></code></pre></div>
<p><img src="metabolomics_files/figure-html/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>And compare to the original plot:</p>
<p><img src="Madssen_1.jpg"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/flipIt.html">flipIt</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="metabolomics_files/figure-html/unnamed-chunk-7-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Note that we used the flipIt() function to flip the loadings and scores to produce similar plots as in the original article.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod</span>, component <span class="op">=</span> <span class="st">"PC2"</span><span class="op">)</span></code></pre></div>
<p><img src="metabolomics_files/figure-html/unnamed-chunk-8-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>As we can see, it looks indeed as a very good match with the original findings.</p>
<p>Let us validate our model (outside knitr, it uses about 2 seconds per run),</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod.val</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/validate.html">validate</a></span><span class="op">(</span><span class="va">mod</span>, participantColumn <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span>
<span class="co">#&gt; Running validation...</span>
<span class="co">#&gt; - Run  1  of  50 </span>
<span class="co">#&gt; --- Used  3.26  seconds. Est. time remaining:  159.77  seconds </span>
<span class="co">#&gt; - Run  2  of  50 </span>
<span class="co">#&gt; --- Used  3.55  seconds. Est. time remaining:  163.48  seconds </span>
<span class="co">#&gt; - Run  3  of  50 </span>
<span class="co">#&gt; --- Used  2.95  seconds. Est. time remaining:  152.89  seconds </span>
<span class="co">#&gt; - Run  4  of  50</span>
<span class="co">#&gt; Warning in GPForth(L, Tmat = Tmat, normalize = normalize, eps = eps, maxit =</span>
<span class="co">#&gt; maxit, : convergence not obtained in GPForth. 1000 iterations used.</span>
<span class="co">#&gt; --- Used  3.04  seconds. Est. time remaining:  147.23  seconds </span>
<span class="co">#&gt; - Run  5  of  50 </span>
<span class="co">#&gt; --- Used  2.92  seconds. Est. time remaining:  141.52  seconds </span>
<span class="co">#&gt; - Run  6  of  50 </span>
<span class="co">#&gt; --- Used  3.03  seconds. Est. time remaining:  137.53  seconds </span>
<span class="co">#&gt; - Run  7  of  50 </span>
<span class="co">#&gt; --- Used  2.94  seconds. Est. time remaining:  133.23  seconds </span>
<span class="co">#&gt; - Run  8  of  50 </span>
<span class="co">#&gt; --- Used  2.98  seconds. Est. time remaining:  129.51  seconds </span>
<span class="co">#&gt; - Run  9  of  50 </span>
<span class="co">#&gt; --- Used  3.04  seconds. Est. time remaining:  126.2  seconds </span>
<span class="co">#&gt; - Run  10  of  50 </span>
<span class="co">#&gt; --- Used  2.96  seconds. Est. time remaining:  122.64  seconds </span>
<span class="co">#&gt; - Run  11  of  50 </span>
<span class="co">#&gt; --- Used  2.9  seconds. Est. time remaining:  119  seconds </span>
<span class="co">#&gt; - Run  12  of  50 </span>
<span class="co">#&gt; --- Used  2.95  seconds. Est. time remaining:  115.63  seconds </span>
<span class="co">#&gt; - Run  13  of  50 </span>
<span class="co">#&gt; --- Used  3.08  seconds. Est. time remaining:  112.69  seconds </span>
<span class="co">#&gt; - Run  14  of  50 </span>
<span class="co">#&gt; --- Used  3.2  seconds. Est. time remaining:  110.05  seconds </span>
<span class="co">#&gt; - Run  15  of  50 </span>
<span class="co">#&gt; --- Used  3.41  seconds. Est. time remaining:  107.81  seconds </span>
<span class="co">#&gt; - Run  16  of  50 </span>
<span class="co">#&gt; --- Used  3.1  seconds. Est. time remaining:  104.77  seconds </span>
<span class="co">#&gt; - Run  17  of  50 </span>
<span class="co">#&gt; --- Used  2.98  seconds. Est. time remaining:  101.5  seconds </span>
<span class="co">#&gt; - Run  18  of  50 </span>
<span class="co">#&gt; --- Used  3.07  seconds. Est. time remaining:  98.41  seconds </span>
<span class="co">#&gt; - Run  19  of  50 </span>
<span class="co">#&gt; --- Used  3.07  seconds. Est. time remaining:  95.33  seconds </span>
<span class="co">#&gt; - Run  20  of  50 </span>
<span class="co">#&gt; --- Used  2.97  seconds. Est. time remaining:  92.1  seconds </span>
<span class="co">#&gt; - Run  21  of  50 </span>
<span class="co">#&gt; --- Used  2.98  seconds. Est. time remaining:  88.91  seconds </span>
<span class="co">#&gt; - Run  22  of  50 </span>
<span class="co">#&gt; --- Used  2.94  seconds. Est. time remaining:  85.68  seconds </span>
<span class="co">#&gt; - Run  23  of  50 </span>
<span class="co">#&gt; --- Used  3.08  seconds. Est. time remaining:  82.64  seconds </span>
<span class="co">#&gt; - Run  24  of  50 </span>
<span class="co">#&gt; --- Used  2.97  seconds. Est. time remaining:  79.47  seconds </span>
<span class="co">#&gt; - Run  25  of  50 </span>
<span class="co">#&gt; --- Used  2.96  seconds. Est. time remaining:  76.32  seconds </span>
<span class="co">#&gt; - Run  26  of  50 </span>
<span class="co">#&gt; --- Used  3.17  seconds. Est. time remaining:  73.37  seconds </span>
<span class="co">#&gt; - Run  27  of  50 </span>
<span class="co">#&gt; --- Used  2.93  seconds. Est. time remaining:  70.2  seconds </span>
<span class="co">#&gt; - Run  28  of  50 </span>
<span class="co">#&gt; --- Used  2.94  seconds. Est. time remaining:  67.06  seconds </span>
<span class="co">#&gt; - Run  29  of  50 </span>
<span class="co">#&gt; --- Used  2.87  seconds. Est. time remaining:  63.89  seconds </span>
<span class="co">#&gt; - Run  30  of  50 </span>
<span class="co">#&gt; --- Used  2.98  seconds. Est. time remaining:  60.8  seconds </span>
<span class="co">#&gt; - Run  31  of  50 </span>
<span class="co">#&gt; --- Used  2.96  seconds. Est. time remaining:  57.71  seconds </span>
<span class="co">#&gt; - Run  32  of  50 </span>
<span class="co">#&gt; --- Used  2.95  seconds. Est. time remaining:  54.63  seconds </span>
<span class="co">#&gt; - Run  33  of  50 </span>
<span class="co">#&gt; --- Used  3.13  seconds. Est. time remaining:  51.64  seconds </span>
<span class="co">#&gt; - Run  34  of  50 </span>
<span class="co">#&gt; --- Used  3  seconds. Est. time remaining:  48.58  seconds </span>
<span class="co">#&gt; - Run  35  of  50 </span>
<span class="co">#&gt; --- Used  3.1  seconds. Est. time remaining:  45.58  seconds </span>
<span class="co">#&gt; - Run  36  of  50 </span>
<span class="co">#&gt; --- Used  2.93  seconds. Est. time remaining:  42.5  seconds </span>
<span class="co">#&gt; - Run  37  of  50 </span>
<span class="co">#&gt; --- Used  3.01  seconds. Est. time remaining:  39.45  seconds </span>
<span class="co">#&gt; - Run  38  of  50 </span>
<span class="co">#&gt; --- Used  3.25  seconds. Est. time remaining:  36.48  seconds </span>
<span class="co">#&gt; - Run  39  of  50 </span>
<span class="co">#&gt; --- Used  3  seconds. Est. time remaining:  33.43  seconds </span>
<span class="co">#&gt; - Run  40  of  50 </span>
<span class="co">#&gt; --- Used  2.94  seconds. Est. time remaining:  30.37  seconds </span>
<span class="co">#&gt; - Run  41  of  50 </span>
<span class="co">#&gt; --- Used  3.18  seconds. Est. time remaining:  27.36  seconds </span>
<span class="co">#&gt; - Run  42  of  50 </span>
<span class="co">#&gt; --- Used  2.97  seconds. Est. time remaining:  24.31  seconds </span>
<span class="co">#&gt; - Run  43  of  50 </span>
<span class="co">#&gt; --- Used  3.03  seconds. Est. time remaining:  21.27  seconds </span>
<span class="co">#&gt; - Run  44  of  50 </span>
<span class="co">#&gt; --- Used  2.95  seconds. Est. time remaining:  18.22  seconds </span>
<span class="co">#&gt; - Run  45  of  50 </span>
<span class="co">#&gt; --- Used  3.02  seconds. Est. time remaining:  15.18  seconds </span>
<span class="co">#&gt; - Run  46  of  50 </span>
<span class="co">#&gt; --- Used  3.15  seconds. Est. time remaining:  12.15  seconds </span>
<span class="co">#&gt; - Run  47  of  50 </span>
<span class="co">#&gt; --- Used  3.09  seconds. Est. time remaining:  9.12  seconds </span>
<span class="co">#&gt; - Run  48  of  50 </span>
<span class="co">#&gt; --- Used  3  seconds. Est. time remaining:  6.08  seconds </span>
<span class="co">#&gt; - Run  49  of  50 </span>
<span class="co">#&gt; --- Used  3  seconds. Est. time remaining:  3.04  seconds </span>
<span class="co">#&gt; - Run  50  of  50 </span>
<span class="co">#&gt; --- Used  3.1  seconds. Est. time remaining:  0  seconds</span></code></pre></div>
<p>The result <strong>Her blir det feil av en eller annen grunn…</strong>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod.val</span><span class="op">)</span></code></pre></div>
<p><img src="metabolomics_files/figure-html/unnamed-chunk-10-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mod.val</span>, component <span class="op">=</span> <span class="st">"PC2"</span><span class="op">)</span></code></pre></div>
<p><img src="metabolomics_files/figure-html/unnamed-chunk-10-2.png" width="100%" style="display: block; margin: auto;"></p>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-eucedaEvaluationMetabolomicChanges2017" class="csl-entry">
Euceda, Leslie R., Tonje H. Haukaas, Guro F. Giskeødegård, Riyas Vettukattil, Jasper Engel, Laxmi Silwal-Pandit, Steinar Lundgren, et al. 2017. <span>“Evaluation of Metabolomic Changes During Neoadjuvant Chemotherapy Combined with Bevacizumab in Breast Cancer Using <span>MR</span> Spectroscopy.”</span> <em>Metabolomics</em> 13 (4): 37. <a href="https://doi.org/10.1007/s11306-017-1168-0">https://doi.org/10.1007/s11306-017-1168-0</a>.
</div>
<div id="ref-madssenRepeatedMeasuresASCA2020a" class="csl-entry">
Madssen, Torfinn S., Guro F. Giskeødegård, Age K. Smilde, and Johan A. Westerhuis. 2020. <span>“Repeated Measures <span>ASCA</span>+ for Analysis of Longitudinal Intervention Studies with Multivariate Outcome Data.”</span> <em>medRxiv</em>, December, 2020.12.03.20243097. <a href="https://doi.org/10.1101/2020.12.03.20243097">https://doi.org/10.1101/2020.12.03.20243097</a>.
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Anders H. Jarmund.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
